{% extends "final/layout.html" %} {% block body %}
<div class="container">
  {% if message %} {% if update %}
  <div class="alert alert-success" role="alert">{{ message }}</div>
  {% else %}
  <div class="alert alert-danger" role="alert">{{ message }}</div>
  {% endif %} {% endif %}
</div>
<div class="row mx-3">
  {% if user.is_authenticated %} {% if isowner %}
  <form
    action="{% url 'closeAuction' id=listing.id %}"
    method="POST"
    class="mx-3"
  >
    {% csrf_token %}
    <button type="submit" class="btn btn-danger">close</button>
  </form>
  {% endif %} {% if isinwatchlist %}
  <form action="{% url 'removewatchlist' id=listing.id %}" method="POST">
    {% csrf_token %}
    <button type="submit" class="btn btn-danger">remove from watchlist</button>
  </form>
  {% else %}
  <form action="{% url 'addwatchlist' id=listing.id %}" method="POST">
    {% csrf_token %}
    <button type="submit" class="btn btn-success">add To watchlist</button>
  </form>
  {% endif %} {% endif %}
</div>

<h1>{{ listing.title }}</h1>
<img src="{{ listing.ImageUrl }}" alt="{{ listing.title }}" height="400px" />
<h2>Description:</h2>
<p>{{ listing.description }}</p>
<p><b>Owner:</b> {{ listing.owner }}</p>
<h4><b>price:</b> ${{ listing.price.bid }}</h4>

<p>{{ message }}</p>

<h2>Comments</h2>
<br />
{% if user.is_authenticated %}
<form action="{% url 'addComment' id=listing.id %}" method="POST">
  {% csrf_token %}
  <div class="form-group">
    <label for="addComment">Add Comment:</label>
    <input type="text" name="addComment" placeholder="Add Comment" />
    <button type="submit" class="btn btn-success">Add Comment</button>
  </div>
</form>
{% endif %}
<br />
<ul class="list-group">
  {% for comment in allcomments %}
  <li class="list-group-item">
    <p><strong>{{ comment.author }}</strong> Posted:</p>
    {{ comment.message }}
  </li>
  {% endfor %}
</ul>

{% endblock %}
